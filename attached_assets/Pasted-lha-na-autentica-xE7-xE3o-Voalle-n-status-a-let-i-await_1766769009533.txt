lha na autentica\xE7\xE3o Voalle: ${n.status} - ${a}`)}let i=await n.json();return this.accessToken=i.access_token,this.tokenExpiresAt=new Date(Date.now()+(i.expires_in-60)*1e3),this.accessToken}async apiRequest(e,r,n){if(!this.config)throw new Error("Voalle n\xE3o configurado");let i=await this.authenticate(),a=`${this.config.apiUrl}:45715/external/integrations/thirdparty${r}`,s={Authorization:`Bearer ${i}`,"Content-Type":"application/json"};this.config.synV1Token&&(s["syn-v1-token"]=this.config.synV1Token);let o=await fetch(a,{method:e,headers:s,body:n?JSON.stringify(n):void 0});if(!o.ok){let u=await o.text();throw new Error(`Voalle API error: ${o.status} - ${u}`)}return o.json()}async testConnection(){if(!this.config)return{success:!1,message:"Voalle n\xE3o configurado"};try{return await this.authenticate(),{success:!0,message:"Conex\xE3o com Voalle estabelecida com sucesso"}}catch(e){return{success:!1,message:`Falha na conex\xE3o: ${e instanceof Error?e.message:"Erro desconhecido"}`}}}async createProtocol(e,r,n,i){if(!this.config)return{success:!1,message:"Voalle n\xE3o configurado"};try{let a={falha_eletrica:"Falha El\xE9trica",rompimento_fibra:"Rompimento de Fibra",falha_equipamento:"Falha de Equipamento",indefinido:"Causa Indefinida"},s=`[Link Monitor] Incidente - ${n}`,o=`
0|link-monitor  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
0|link-monitor  | Error: DATABASE_URL must be set. Did you forget to provision a database?
0|link-monitor  |     at Object.<anonymous> (/opt/link-monitor/dist/index.cjs:94:111099)
0|link-monitor  |     at Module._compile (node:internal/modules/cjs/loader:1521:14)
0|link-monitor  |     at Module._extensions..js (node:internal/modules/cjs/loader:1623:10)
0|link-monitor  |     at Module.load (node:internal/modules/cjs/loader:1266:32)
0|link-monitor  |     at Module._load (node:internal/modules/cjs/loader:1091:12)
0|link-monitor  |     at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:164:12)
0|link-monitor  |     at node:internal/main/run_main_module:28:49
0|link-monitor  | Node.js v20.19.6
^C